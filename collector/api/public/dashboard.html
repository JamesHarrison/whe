<!DOCTYPE html>
<html>
<head>
  <title>WHE</title>
  <script src="/faye/client.js"></script>
  <script src="/js/jquery-2.1.3.min.js"></script>
</head>
<body>
  <h1>Dashboard</h1>
  <button onclick="trigger()">Trigger</button>
  <button onclick="postMetadata()">POST /metadata</button>
  <script>
    var client = new Faye.Client('http://localhost:3000/faye');

    // Display heartbeats of all clients
    client.subscribe('/heartbeat', function (thing) {
      console.log('Heartbeat: type: %o, id: %o', thing.type, thing.id);
    });

    function trigger() {
      client.publish('/trigger', {})
        .then(success, fail);
    }

    function postMetadata() {
      var url = '/metadata',
          opts = {
            method: 'POST',
            data: '{"data": [{"source":"moz1","id": "18:34:51:01:F4:32", "time": "1423086153", "power": "-46", "company": "Apple", "aps":""}]}',
            contentType: 'application/json'
          };

      $.ajax(url, opts);
    }

    function success() {
      console.log('SUCCESS :-)');
    }

    function fail() {
      console.error('FAIL :-(');
    }
  </script>
</body>
</html>